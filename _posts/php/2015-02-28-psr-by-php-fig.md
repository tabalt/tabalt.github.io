---

layout: post
title:  "PHP标准化规范PSR 0、PSR 1、PSR 2、PSR 3、PSR 4"
date:   2015-02-28 12:30:00
tags: [php]

---

PSR是PHP通用性框架小组 （[PHP Framework Interop Group](http://www.php-fig.org/)） 制定的PHP规范，是PHP开发的事实标准。

截止到目前（2015年2月），正式发布过的PHP规范共有5个：

* PSR 0 自动加载标准（已废弃，被PSR 4取代）
* PSR 1 基本代码规范
* PSR 2 代码风格指南
* PSR 3 日志接口
* PSR 4 改进的自动加载

那么使用、遵循PSR标准有什么必要和好处呢？

作为一名Go语言脑残粉，最开始让我怦然心动的就是那个全世界强制统一的编码规范。统一的编码风格，可以让我们轻松愉悦地阅读他人的代码，以及编写让他人轻松愉悦的代码。

就PSR规范本身来说，个人觉得是非常优秀、简洁的实践结晶。遵循这些标准，除了能使我们的代码更加可读之外，还能让我们的程序更加健壮，更能提高开发者的个人素养。


下面罗列一下PSR 1 ~ PSR 4的主要内容（已废弃的PSR 0不再介绍）：


### PSR 1 基本代码规范

* 代码中只使用长标签 `<?php ?>` 和 短输出标签`<?= ?>`
* 文件编码只使用UTF-8 无BOM 格式
* 一个源文件建议只用来做声明（类(class)，函数(function)，常量(constant)等）或者只用来做一些引起副作用的操作（例如：输出信息，修改.ini配置等）,不建议同时做这两件事
	* 应该避免的例子，既包含声明又有副作用：

			<?php
			// 副作用：修改了ini配置
			ini_set('error_reporting', E_ALL);
			
			// 副作用：载入了文件
			include "file.php";
			
			// 副作用：产生了输出
			echo "<html>\n";
			
			// 声明
			function foo()
			{
			    // 函数体
			}	

	* 提倡的例子，仅包含声明：

			<?php
			// 声明
			function foo()
			{
			    // 函数体
			}
			
			// 条件式声明不算做是副作用
			if (! function_exists('bar')) {
			    function bar()
			    {
			        // 函数体
			    }
			}

* 一个源文件中只能有一个类(class)，并且每个类(class)至少要有一级空间名（namespace）：即一个顶级的组织名(vendor name)。类名(class name) 必须使用StudlyCaps（骆驼式）写法

		<?php
		namespace Vendor\Model;
		
		class Foo
		{
		}

* 类常量必须只由大写字母和下划线(_)组成：

		<?php
		namespace Vendor\Model;
		
		class Foo
		{
		    const VERSION = '1.0';
		    const DATE_APPROVED = '2012-06-01';
		}

* 类属性命名依据喜好选择形如 $StulyCaps，$camelCase 或者 $unser_score 中的风格，并在一个合理的范围内保持一致
* 方法名必须使用camelCase(驼峰式)风格来声明。



### PSR 2 代码风格指南

* 代码使用4个空格来进行缩进，不使用制表符；使用Unix LF(换行)作为行结束符
* 一行代码的长度不建议有硬限制；软限制必须为120个字符，建议每行代码80个字符或者更少
* 在命名空间(namespace)的声明下面必须有一行空行，并且在导入(use)的声明下面也必须有一行空行
* 类(class)的左花括号必须放到其声明下面自成一行，右花括号则必须放到类主体下面自成一行
* 方法(method)的左花括号必须放到其声明下面自成一行，右花括号则必须放到方法主体的下一行
* 所有的属性(property)和方法(method) 必须有可见性声明；抽象(abstract)和终结(final)声明必须在可见性声明之前；而静态(static)声明必须在可见性声明之后
* 所有的属性(property)和方法(method) 必须有可见性声明；抽象(abstract)和终结(final)声明必须在可见性声明之前；而静态(static)声明必须在可见性声明之后
* 控制结构的左花括号必须跟其放在同一行，右花括号必须放在该控制结构代码主体的下一行
* 控制结构的左括号之后不可有空格，右括号之前也不可有空格

### PSR 3 日志接口


### PSR 4 改进的自动加载

1. 术语「类」是一个泛称；它包含类，接口，traits 以及其他类似的结构；

2. 完全限定类名应该类似如下范例：

    \<NamespaceName>(\<SubNamespaceNames>)*\<ClassName>

    1. 完全限定类名必须有一个顶级命名空间（Vendor Name）；
    2. 完全限定类名可以有多个子命名空间；
    3. 完全限定类名应该有一个终止类名；
    4. 下划线在完全限定类名中是没有特殊含义的；
    5. 字母在完全限定类名中可以是任何大小写的组合；
    6. 所有类名必须以大小写敏感的方式引用；

3. 当从完全限定类名载入文件时：

    1. 在完全限定类名中，连续的一个或几个子命名空间构成的命名空间前缀（不包括顶级命名空间的分隔符），至少对应着至少一个基础目录。
    2. 在「命名空间前缀」后的连续子命名空间名称对应一个「基础目录」下的子目录，其中的命名
空间分隔符表示目录分隔符。子目录名称必须和子命名空间名大小写匹配；
    3. 终止类名对应一个以 `.php` 结尾的文件。文件名必须和终止类名大小写匹配；

4. 自动载入器的实现不可抛出任何异常，不可引发任何等级的错误；也不应返回值；



有一篇之前博文的内容和这份规范非常契合:[一份PHP编码规范](http://tabalt.net/blog/a-php-coding-standards/)。



